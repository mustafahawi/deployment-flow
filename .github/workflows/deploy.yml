on:
  workflow_call:
    inputs:
      in_env_name:
        type: string
        required: true
      drop_create_db:
        type: boolean
        default: false
      my:
        type: string
        required: true

env:
  MY_ENV_VALUE: ${{inputs.my}}

jobs:
  build:
    name: Deploy
    runs-on: ubuntu-latest
    environment: ${{inputs.in_env_name}}
    steps:            
      - name: Deploy
        run: echo "${{env.MY_ENV_VALUE}}"
      
      - name: Set up secret file
        run: |
          echo "${{env.MY_ENV_VALUE}}" >> secrets.txt
          echo $MY_ENV_VALUE >> secrets.txt

      - name: Run tmate
        if: "${{ inputs.drop_create_db === false }}"
        run: echo "Migrate"

      - name: Run tmate
        if: "${{ inputs.drop_create_db === true }}"
        run: echo "DROP AND CREATE"
        ## uses: mxschmitt/action-tmate@v2